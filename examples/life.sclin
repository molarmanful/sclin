30=$n.
"Ixs"@# =$ixs.
$n "Grid"@#.
"loop"@#

#Grid O>a 2^` ( 0 1, :r , ) map >M

#loop.
  ( show next )#.
  ; @
  show $n next

#next ( grid n )=.
  $grid (( k v )=.) map
    $ixs $k.+ map $n %.
    ( $grid swap :` ) map +/.
    3 4, = ,_ $v * - abs.
    $k swap

#Ixs 2O-a1- 2^` >A

#show dup.
  ."\u001b[H\u001b[J">o.
  0 $n *` ,, $n *` ( rot :/= ) fold.
  ".#"swap : ( w>< n>o ) tap pop